<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>blog</title>
<link>https://avivleemann.github.io/blog/index.html</link>
<atom:link href="https://avivleemann.github.io/blog/index.xml" rel="self" type="application/rss+xml"/>
<description>my blog</description>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Sun, 05 Mar 2023 22:00:00 GMT</lastBuildDate>
<item>
  <title>atrocytoma</title>
  <dc:creator>Aviv Leemann</dc:creator>
  <link>https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index.html</link>
  <description><![CDATA[ 



<section id="single-cell-analysis---astrocytoma" class="level2">
<h2 class="anchored" data-anchor-id="single-cell-analysis---astrocytoma">single cell analysis - astrocytoma</h2>
<p>astrocytoma data was obtained from single cell portal. single cell analysis executed with <strong>R</strong> program and Seurat package, Pallad expression was examined in astrocytoma data.</p>
</section>
<section id="libreries" class="level2">
<h2 class="anchored" data-anchor-id="libreries">libreries</h2>
<p>pacman library purpose is to load multiple libraries from a vector</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pacman)</span>
<span id="cb1-2">labrvec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggpubr"</span>,</span>
<span id="cb1-3">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Seurat"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"future"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fsthet"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"patchwork"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stringr"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"readxl"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stats"</span>)</span>
<span id="cb1-4"></span>
<span id="cb1-5">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(labrvec,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">install =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">character.only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</section>
<section id="files" class="level2">
<h2 class="anchored" data-anchor-id="files">files</h2>
<p>loading RDS file after analysis, instead of building the file</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load RDS file</span></span>
<span id="cb2-2">astrocytoma_seurat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"astrocytomaWmetadata.rds"</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># seg genes palld astrocytoma </span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#seg.genes.csv &lt;- read.delim2("hsa_seek_palld_astro_exp.txt",  sep="\t",header = F,  stringsAsFactors = F,check.names = FALSE)</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # reading metada file</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma.metadata&lt;-read.csv(file = "IDH_A_cell_type_assignment_portal_v2.txt",sep ="\t" )</span></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # reading count matrix file</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma.matrix &lt;- read.csv(file = "IDH_A_processed_data_portal.txt",sep ="\t",check.names = FALSE)</span></span></code></pre></div>
</section>
<section id="processing-data" class="level2">
<h2 class="anchored" data-anchor-id="processing-data">processing data</h2>
<p>editing features to work with Seurat package</p>
<p>reading metadata looking &amp; processing</p>
<p>head(astrocytoma_metadata)</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># seg.genes.csv &lt;- seg.genes.csv[5:nrow(seg.genes.csv),]</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #head(seg.genes.csv)</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># colnames(seg.genes.csv) &lt;-  seg.genes.csv[1,]</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames(seg.genes.csv) &lt;- seg.genes.csv$Rank</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># seg.genes.csv &lt;- seg.genes.csv[-1,-1]</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # adding padj</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># seg.genes.csv$Padj &lt;- p.adjust(seg.genes.csv$`P-Value`,method = "fdr")</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># seg.padj.genes &lt;- filter(seg.genes.csv,Padj &lt; 0.05)</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames(seg.genes.csv) &lt;- seg.genes.csv[,2]</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># colnames(seg.genes.csv) &lt;- seg.genes.csv[2,]</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # changing the row names to genes and deliting the column</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames(astrocytoma.matrix) &lt;-  astrocytoma.matrix$Gene</span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma.matrix &lt;-  astrocytoma.matrix[,-1]</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ## cleaning duplicate names of cells</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma.metadata[which(duplicated(astrocytoma.metadata$NAME)),]</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma.metadata &lt;-  astrocytoma.metadata[-1106,]</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # removing the first row in the meta data dont relevent</span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma.metadata &lt;- astrocytoma.metadata[-1,]</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # changing metadata row names to cells names</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames(astrocytoma.metadata) &lt;- astrocytoma.metadata$NAME</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # removing the column of name from the metadata</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma.metadata &lt;- astrocytoma.metadata[,-1]</span></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # looking at the edited metadata</span></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dim(astrocytoma.metadata)</span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dim(astrocytoma.matrix)</span></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># row.names(astrocytoma.metadata) &lt;-  remove.spaces(row.names(astrocytoma.metadata) ) </span></span>
<span id="cb3-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># row.names(astrocytoma.metadata) &lt;- str_replace_all(row.names(astrocytoma.metadata) ,"[\\.-]" , "_")</span></span>
<span id="cb3-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># colnames(astrocytoma.matrix)&lt;- str_replace_all(colnames(astrocytoma.matrix), "[\\.-]", "_")</span></span>
<span id="cb3-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # setdiff(x = row.names(astrocytoma.metadata),y = colnames(astrocytoma.matrix))</span></span>
<span id="cb3-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # setdiff(x =colnames(astrocytoma.matrix),y = row.names(astrocytoma.metadata) )</span></span>
<span id="cb3-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # creating saeurat object without metadata for the workflow and avoiding unspesified cells </span></span>
<span id="cb3-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # thos cells will apear in the metadata as NA</span></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma_seurat &lt;- CreateSeuratObject(</span></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   astrocytoma.matrix,</span></span>
<span id="cb3-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   project = "astrocytomaProject",</span></span>
<span id="cb3-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   assay = "RNA",</span></span>
<span id="cb3-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   min.cells = 0,</span></span>
<span id="cb3-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   min.features = 0,</span></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   names.field = 1,</span></span>
<span id="cb3-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   names.delim = "_",</span></span>
<span id="cb3-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   meta.data = astrocytoma.metadata ,</span></span>
<span id="cb3-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb3-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # row.names(astrocytoma_seurat)</span></span>
<span id="cb3-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # table(astrocytoma_seurat@meta.data$CLUSTER)</span></span>
<span id="cb3-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #sammury seurat object</span></span>
<span id="cb3-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #astrocytoma_seurat</span></span>
<span id="cb3-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Idents(astrocytoma_seurat) &lt;- "astrocytoma"</span></span>
<span id="cb3-50"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Idents</span>(astrocytoma_seurat) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CLUSTER"</span></span>
<span id="cb3-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># looking for mitochondrial DNA</span></span>
<span id="cb3-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma_seurat[["percent.mt"]] &lt;- PercentageFeatureSet(object = astrocytoma_seurat, pattern = "^MT-")</span></span>
<span id="cb3-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plotting the available data of Ncount RNA mitochondrial dna and nfeature rna</span></span>
<span id="cb3-54">plot1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FeatureScatter</span>(astrocytoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span>)</span>
<span id="cb3-55">plot2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FeatureScatter</span>(astrocytoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span>)</span>
<span id="cb3-56">plot2 </span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/processing-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">plot1</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/processing-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># violin plot for each</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(astrocytoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pt.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/processing-3.jpeg" class="img-fluid"></p>
</section>
<section id="feature-plot" class="level2">
<h2 class="anchored" data-anchor-id="feature-plot">Feature-plot</h2>
<p>most significant genes</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # theshold where chosen by the violin plot above and its seems there isnt mitochondrial in data </span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma_seurat &lt;- subset(astrocytoma_seurat, subset = nFeature_RNA &gt; 2500 &amp; nFeature_RNA &lt; 10000) </span></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # normalize data</span></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #astrocytoma_seurat &lt;- NormalizeData(astrocytoma_seurat)</span></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ## Variable gene selection ----</span></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma_seurat &lt;- FindVariableFeatures(astrocytoma_seurat, selection.method = "vst", nfeatures = 2000)</span></span>
<span id="cb6-7"></span>
<span id="cb6-8">top10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VariableFeatures</span>(astrocytoma_seurat), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># top10</span></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot variable features with and without labels</span></span>
<span id="cb6-11">plot1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VariableFeaturePlot</span>(astrocytoma_seurat)</span>
<span id="cb6-12">plot2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">LabelPoints</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> plot1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">points =</span> top10, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-13">plot1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot2</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/Feature plot-1.jpeg" class="img-fluid"></p>
</section>
<section id="dimplot-heatmap" class="level2">
<h2 class="anchored" data-anchor-id="dimplot-heatmap">Dimplot &amp; heatmap</h2>
<p>astrocytoma_seurat &lt;- ScaleData(astrocytoma_seurat)</p>
<p>astrocytoma_seurat &lt;- RunPCA(astrocytoma_seurat, features = VariableFeatures(object = astrocytoma_seurat))</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VizDimLoadings</span>(astrocytoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/Dimplot &amp; heatmap-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(astrocytoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/Dimplot &amp; heatmap-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimHeatmap</span>(astrocytoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cells =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/Dimplot &amp; heatmap-3.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimHeatmap</span>(astrocytoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cells =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/Dimplot &amp; heatmap-4.jpeg" class="img-fluid"></p>
</section>
<section id="elbowplot-jackstraw-plot" class="level2">
<h2 class="anchored" data-anchor-id="elbowplot-jackstraw-plot">elbowplot &amp; jackstraw plot</h2>
<p>astrocytoma_seurat &lt;- JackStraw(astrocytoma_seurat, num.replicate = 100)</p>
<p>astrocytoma_seurat &lt;- ScoreJackStraw(astrocytoma_seurat, dims = 1:20)</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">JackStrawPlot</span>(astrocytoma_seurat,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/elbowplot &amp; jackstraw plot-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ElbowPlot</span>(astrocytoma_seurat)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/elbowplot &amp; jackstraw plot-2.jpeg" class="img-fluid"></p>
</section>
<section id="umap-tsne-plot" class="level2">
<h2 class="anchored" data-anchor-id="umap-tsne-plot">Umap &amp; tsne plot</h2>
<p>unspecified in this case was ignored</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma_seurat &lt;- FindNeighbors(astrocytoma_seurat, dims = 1:10)</span></span>
<span id="cb13-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma_seurat &lt;- FindClusters(astrocytoma_seurat, resolution = 0.5)</span></span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Look at cluster IDs of the first 5 cells</span></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># head(Idents(astrocytoma_seurat), 15)</span></span>
<span id="cb13-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># astrocytoma_seurat &lt;- RunUMAP(astrocytoma_seurat, dims = 1:10)</span></span>
<span id="cb13-6">astrocytoma_seurat_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(astrocytoma_seurat,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subset =</span> CLUSTER <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unspecified"</span> )</span>
<span id="cb13-7">my_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-cells"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oligodendrocytes"</span> ,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malignant"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Microglia/Macrophage"</span>)</span>
<span id="cb13-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Idents</span>(astrocytoma_seurat_2) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Idents</span>(astrocytoma_seurat_2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels=</span> )</span>
<span id="cb13-9"></span>
<span id="cb13-10">astrocytoma_seurat_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>meta.data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>CLUSTER <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> astrocytoma_seurat_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>meta.data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>CLUSTER, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Microglia/Macrophage"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malignant"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oligodendrocytes"</span> ,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-cells"</span>))</span>
<span id="cb13-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(astrocytoma_seurat_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CLUSTER"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CellAssignment"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/umap &amp; tsne-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(astrocytoma_seurat_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tsne"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CLUSTER"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CellAssignment"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/umap &amp; tsne-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># table(astrocytoma_seurat@meta.data$CLUSTER)</span></span>
<span id="cb15-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># note that you can set `label = TRUE` or use the LabelClusters function to help label</span></span>
<span id="cb15-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># individual clusters</span></span></code></pre></div>
</section>
<section id="violin-plot" class="level2">
<h2 class="anchored" data-anchor-id="violin-plot">Violin Plot</h2>
<p>expression of palld in malignant cell is significant</p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">my_comp_astro <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malignant"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Microglia/Macrophage"</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oligodendrocytes"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malignant"</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-cells"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malignant"</span>),</span>
<span id="cb16-2">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-cells"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oligodendrocytes"</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-cells"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Microglia/Macrophage"</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Microglia/Macrophage"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oligodendrocytes"</span>))</span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(astrocytoma_seurat_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PALLD"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CLUSTER"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pt.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_compare_means</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'kruskal.test'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.y =</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylim</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cell Type"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_summary</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun.data =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_sdl"</span>,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pointrange"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_signif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comparisons =</span> my_comp_astro,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">map_signif_level =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_position=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NoLegend</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb16-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>))</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index_files/figure-html/violin plot-1.jpeg" class="img-fluid"></p>


</section>

 ]]></description>
  <category>single cell</category>
  <category>atrocytoma</category>
  <guid>https://avivleemann.github.io/blog/blog/posts/2023-03-06-astrocytoma/index.html</guid>
  <pubDate>Sun, 05 Mar 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Breast cancer</title>
  <dc:creator>Aviv Leemann</dc:creator>
  <link>https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index.html</link>
  <description><![CDATA[ 



<section id="single-cell-breast-cancer--analysis" class="level1">
<h1>single cell Breast cancer -analysis</h1>
<p>Breast cancer data was obtained from single cell portal. single cell analysis executed with <strong>R</strong> program and Seurat package, Pallad expression was examined in Breast cancer data.<br>
our lab found PALLD express in breast cancr, PALLD expression was examined between different cell type , different cluster groups, alsotop 10 mrker for each cluster was obtained</p>
<section id="libreries" class="level2">
<h2 class="anchored" data-anchor-id="libreries">libreries</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pacman)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(Seurat)</span>
<span id="cb1-3">labrvec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Matrix"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AnnotationDbi"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"readxl"</span>,</span>
<span id="cb1-4">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Seurat"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"future"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"patchwork"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stringr"</span>)</span>
<span id="cb1-5">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(labrvec,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">install =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">character.only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</section>
<section id="files" class="level2">
<h2 class="anchored" data-anchor-id="files">files</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reading RDS</span></span>
<span id="cb2-2">BCdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BCdatageneral.rds"</span>)</span></code></pre></div>
</section>
<section id="pre-processing" class="level2">
<h2 class="anchored" data-anchor-id="pre-processing">pre-processing</h2>
<p>wont be used at the creation of this files because already created and RDS will be use</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define nultiprocess for seurat</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Breast.cancer.SCdata&lt;-Read10X(</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   data.dir = indir ,</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   gene.column = 1,</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   unique.features = TRUE,</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   strip.suffix = FALSE</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ) </span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #class(Breast.cancer.SCdata)</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(object.size(Breast.cancer.SCdata), units="Gb")</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # head(Breast.cancer.SCdata)</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mini.atlas &lt;- read.csv('C:/Users/user/Desktop/BCsinglecelldata/Whole_miniatlas_meta.csv')</span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gene_targets &lt;- read_excel("C:/Users/user/Desktop/BCsinglecelldata/spikesearchtargetgenes.xlsx",)</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # summary(mini.atlas)</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gene_targets &lt;- pull(gene_targets,"Gene name")</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gene_targets &lt;- gene_targets[!is.na(gene_targets)]</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gene_targets &lt;- gene_targets[1:128]</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gene_targets &lt;- gene_targets[!duplicated(gene_targets)]</span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #gene_targets</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># colnames(mini.atlas)[1] &lt;- "NAMES"</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #mini.atlas</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rownames(mini.atlas) &lt;- pull(mini.atlas,"NAMES") </span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #mini.atlas.C &lt;- mini.atlas %&gt;% filter(normal_cell_call == "cancer")</span></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cancer.cell.types &lt;- pull(mini.atlas,"normal_cell_call") %&gt;%  unique()</span></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #cancer.cell.types</span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mini.atlas &lt;- mini.atlas[-1,-1]</span></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # head(mini.atlas)</span></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- CreateSeuratObject(</span></span>
<span id="cb3-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   Breast.cancer.SCdata,</span></span>
<span id="cb3-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   project = "BC",</span></span>
<span id="cb3-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   assay = "RNA",</span></span>
<span id="cb3-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   min.cells = 0,</span></span>
<span id="cb3-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   min.features = 0,</span></span>
<span id="cb3-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   names.field = 1,</span></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   names.delim = "_",</span></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   meta.data = mini.atlas</span></span>
<span id="cb3-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb3-38"></span>
<span id="cb3-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># looking at the idents in seurat object</span></span>
<span id="cb3-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># head(BCdata[[]])</span></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #BCdata</span></span>
<span id="cb3-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata@meta.data$project &lt;- "BC"</span></span>
<span id="cb3-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- StashIdent(object = BCdata, save.name = "old.ident")</span></span>
<span id="cb3-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Idents(object = BCdata) &lt;- "project"</span></span>
<span id="cb3-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Idents(object = BCdata)</span></span>
<span id="cb3-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#BCdata &lt;- subset(x = BCdata, idents = "cancer")</span></span>
<span id="cb3-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># row.names(BCdata)</span></span>
<span id="cb3-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # BCdata[[]]</span></span>
<span id="cb3-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # extract the mitochondrial DNA</span></span>
<span id="cb3-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata[["Percent_mito"]] &lt;-unlist(BCdata[["Percent_mito"]]) %&gt;% as.numeric()</span></span>
<span id="cb3-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata[["nCount_RNA"]] &lt;-unlist(BCdata[["nCount_RNA"]]) %&gt;% as.numeric()</span></span>
<span id="cb3-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata[["nFeature_RNA"]] &lt;-unlist(BCdata[["nFeature_RNA"]]) %&gt;% as.numeric()</span></span>
<span id="cb3-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata[["percent.mt"]] &lt;- PercentageFeatureSet(object = BCdata, pattern = "^MT-")</span></span>
<span id="cb3-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># #Idents(object = BCdata) &lt;- "celltype_subset"</span></span>
<span id="cb3-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata[["normal_cell_call"]] %&gt;%  unique()</span></span>
<span id="cb3-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fixing to column Percent_mito as numeric</span></span></code></pre></div>
</section>
<section id="feature-scatter-violin" class="level2">
<h2 class="anchored" data-anchor-id="feature-scatter-violin">Feature-scatter &amp; violin</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Idents</span>(BCdata) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Breast cancer"</span></span>
<span id="cb4-2"></span>
<span id="cb4-3">plot1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FeatureScatter</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percent_mito"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">raster=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb4-4">plot2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FeatureScatter</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">raster=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb4-5">plot2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot1</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/feature scatter-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percent_mito"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pt.size  =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/feature scatter-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percent_mito"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/feature scatter-3.jpeg" class="img-fluid"></p>
</section>
<section id="variable-feature-plot" class="level2">
<h2 class="anchored" data-anchor-id="variable-feature-plot">variable Feature-plot</h2>
<p>BCdata &lt;- NormalizeData(BCdata)</p>
<p>BCdata &lt;- FindVariableFeatures(BCdata, selection.method = “vst”, nfeatures = 2000)</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## what are our variable genes ?</span></span>
<span id="cb7-2">top10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VariableFeatures</span>(BCdata), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb7-3">top10</span></code></pre></div>
<pre><code>##  [1] "SCGB2A2"   "IGHV1-69"  "SCGB1B2P"  "IGFBP7"    "IGHG1"     "CCL4"     
##  [7] "IGLV2-28"  "IGKV2D-28" "IGKV2D-29" "CD74"</code></pre>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot variable features with and without labels</span></span>
<span id="cb9-2">plot1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VariableFeaturePlot</span>(BCdata)</span>
<span id="cb9-3">plot2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">LabelPoints</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> plot1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">points =</span> top10, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb9-4">plot1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot2</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/variable Feature plot-1.jpeg" class="img-fluid"></p>
</section>
<section id="pca-plot" class="level2">
<h2 class="anchored" data-anchor-id="pca-plot">PCA-plot</h2>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all_genes &lt;- rownames(BCdata)</span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # all_genes</span></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- ScaleData(BCdata)</span></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- RunPCA(BCdata, features = VariableFeatures(object = BCdata))</span></span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VizDimLoadings</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/PCA plot-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/PCA plot-2.jpeg" class="img-fluid"></p>
</section>
<section id="heat-map" class="level2">
<h2 class="anchored" data-anchor-id="heat-map">Heat-map</h2>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Examine and visualize PCA results a few different ways</span></span>
<span id="cb12-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#(BCdata[["pca"]], dims = 1:5, nfeatures = 5)</span></span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimHeatmap</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cells =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/heatmap-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimHeatmap</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cells =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/heatmap-2.jpeg" class="img-fluid"></p>
</section>
<section id="jackstrawplot-elbowplot" class="level2">
<h2 class="anchored" data-anchor-id="jackstrawplot-elbowplot">JackStrawPlot &amp; ElbowPlot</h2>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- JackStraw(BCdata, num.replicate = 100)</span></span>
<span id="cb14-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- ScoreJackStraw(BCdata, dims = 1:20)</span></span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">JackStrawPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/JackStrawPlot &amp; ElbowPlot-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ElbowPlot</span>(BCdata)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/JackStrawPlot &amp; ElbowPlot-2.jpeg" class="img-fluid"></p>
</section>
<section id="umap-tsne" class="level2">
<h2 class="anchored" data-anchor-id="umap-tsne">Umap &amp; tsne</h2>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- FindNeighbors(BCdata, dims = 1:10)</span></span>
<span id="cb16-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- FindClusters(BCdata, resolution = 0.4)</span></span>
<span id="cb16-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- RunUMAP(BCdata, dims = 1:10)</span></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata &lt;- RunTSNE(BCdata, dims = 1:10)</span></span>
<span id="cb16-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Look at cluster IDs of the first 5 cells</span></span>
<span id="cb16-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Idents</span>(BCdata), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)                     </span></code></pre></div>
<pre><code>## CID3586_AAGACCTCAGCATGAG CID3586_AAGGTTCGTAGTACCT CID3586_ACCAGTAGTTGTGGCC 
##            Breast cancer            Breast cancer            Breast cancer 
## CID3586_ACCCACTAGATGTCGG CID3586_ACTTGTTAGGGAAACA 
##            Breast cancer            Breast cancer 
## Levels: Breast cancer</code></pre>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"celltype_major"</span> ,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/unnamed-chunk-1-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tsne"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"celltype_major"</span> ,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/unnamed-chunk-1-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#saveRDS(BCdata, file = "C:/Users/user/Desktop/BCsinglecelldata/BCdata.rds")</span></span></code></pre></div>
</section>
<section id="heat-map-markers-for-each-cell-types-major" class="level2">
<h2 class="anchored" data-anchor-id="heat-map-markers-for-each-cell-types-major">heat map markers for each cell types major</h2>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"celltype_major"</span> , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pt.size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/heat map markers cell type major-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">BCdata.markers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BCdata.markers.rds'</span>)</span>
<span id="cb22-2"></span>
<span id="cb22-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Idents(BCdata) &lt;- "celltype_major"</span></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata.markers &lt;- FindAllMarkers(BCdata, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)</span></span>
<span id="cb22-5">BCdata.markers <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(cluster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">top_n</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">wt =</span> avg_log2FC) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> top10</span>
<span id="cb22-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DoHeatmap</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> top10<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NoLegend</span>()</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/heat map markers cell type major-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># saveRDS(BCdata.markers, file = "BCdata.markers.rds")</span></span></code></pre></div>
</section>
<section id="violin-plot-palld" class="level2">
<h2 class="anchored" data-anchor-id="violin-plot-palld">violin plot PALLD</h2>
</section>
<section id="idnets-normal_cell_call" class="level2">
<h2 class="anchored" data-anchor-id="idnets-normal_cell_call">Idnets normal_cell_call</h2>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Idents</span>(BCdata) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'normal_cell_call'</span></span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span> ,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/unnamed-chunk-2-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tsne"</span> ,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/unnamed-chunk-2-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PALLD"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NoLegend</span>()</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/unnamed-chunk-2-3.jpeg" class="img-fluid"></p>
</section>
<section id="cancer-subset" class="level2">
<h2 class="anchored" data-anchor-id="cancer-subset">cancer subset</h2>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">BCdata_cancer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BCdata_subset_cancer.rds'</span>)</span>
<span id="cb27-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Idents</span>(BCdata_cancer) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"celltype_minor"</span></span></code></pre></div>
</section>
<section id="umap-tsne-cancer-cells" class="level2">
<h2 class="anchored" data-anchor-id="umap-tsne-cancer-cells">umap &amp; tsne cancer cells</h2>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(BCdata_cancer, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/umap &amp; tsne cancer-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(BCdata_cancer, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tsne"</span> ,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/umap &amp; tsne cancer-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(BCdata_cancer, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PALLD"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NoLegend</span>()</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/violin cancer-1.jpeg" class="img-fluid"></p>
</section>
<section id="find-all-marker-by-cancer-idents" class="level2">
<h2 class="anchored" data-anchor-id="find-all-marker-by-cancer-idents">find all marker by cancer idents</h2>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Idents</span>(BCdata) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'normal_cell_call'</span></span>
<span id="cb31-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BCdata_markers_normal_cell_call &lt;- FindAllMarkers(BCdata, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)</span></span>
<span id="cb31-3">BCdata_markers_normal_cell_call <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BCdata_markers_normal_cell_call.rds'</span>)</span>
<span id="cb31-4">BCdata_markers_normal_cell_call <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(cluster) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">top_n</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">wt =</span> avg_log2FC) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> top10</span>
<span id="cb31-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DoHeatmap</span>(BCdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> top10<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NoLegend</span>()</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index_files/figure-html/markers by cancer-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#saveRDS(BCdata_markers_normal_cell_call, file = "BCdata_markers_normal_cell_call.rds")</span></span></code></pre></div>


</section>
</section>

 ]]></description>
  <category>single cell</category>
  <category>breast-cancer</category>
  <guid>https://avivleemann.github.io/blog/blog/posts/2023-03-06-breast-cacner/index.html</guid>
  <pubDate>Sun, 05 Mar 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>glioblastoma</title>
  <dc:creator>aviv leemann</dc:creator>
  <link>https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index.html</link>
  <description><![CDATA[ 



<section id="single-cell-analysis---glioblasotma" class="level2">
<h2 class="anchored" data-anchor-id="single-cell-analysis---glioblasotma">single cell analysis - glioblasotma</h2>
<p>glioblastoma data was obtained from single cell portal. single cell analysis executed with <strong>R</strong> program and Seurat package, Pallad expression was examined in glioblastoma data.</p>
</section>
<section id="libreries" class="level2">
<h2 class="anchored" data-anchor-id="libreries">libreries</h2>
<p>pacman library purpose is to load multiple libraries from a vector</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">labrvec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Seurat"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"future"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stringr"</span>,</span>
<span id="cb1-2">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"readxl"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stats"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggsignif"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reshape2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggpubr"</span>)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#stat_compare_means(test="kruskal.test")</span></span>
<span id="cb1-4">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(labrvec,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">install =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">character.only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggpubr)</span></code></pre></div>
</section>
<section id="files" class="level2">
<h2 class="anchored" data-anchor-id="files">files</h2>
<p>loading relevant files, because i have already prepared the rds for plot i will load the rds file</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">glioblastoma_seurat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glioblastoma_seurat.rds"</span>)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># original files</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_metadata &lt;- read.csv(file = "IDHwt.GBM.Metadata.SS2.txt",sep ="\t",stringsAsFactors = FALSE)</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_expressed_matrix  &lt;- read.csv("IDHwtGBM.processed.SS2.logTPM.txt" ,sep = "\t")</span></span></code></pre></div>
</section>
<section id="processing-data" class="level2">
<h2 class="anchored" data-anchor-id="processing-data">processing data</h2>
<p>editing features to work with Seurat package</p>
<p>reading metadata looking &amp; processing</p>
<p>head(glioblastoma_metadata)</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## data looking</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_seurat &lt;- StashIdent(object = glioblastoma_seurat, save.name = "old.ident")</span></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Idents</span>(glioblastoma_seurat)  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CellAssignment"</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop NA from the seurat object metadata</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_seurat[["percent.mt"]] &lt;- PercentageFeatureSet(object = glioblastoma_seurat, pattern = "^MT-")</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reading metadata &amp; processing metada:</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_metadata &lt;- glioblastoma_metadata[-1,]</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># row.names(glioblastoma_metadata) &lt;- pull(glioblastoma_metadata,"NAME" )</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_metadata &lt;- glioblastoma_metadata[,-1]</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_metadata$GBMType %&gt;% unique()</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_metadata$CellAssignment %&gt;% unique()</span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># colnames(glioblastoma_metadata)</span></span>
<span id="cb3-15"></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reading expression matrix processed</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># processing expression matrix</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># row.names(glioblastoma_expressed_matrix) &lt;- pull(glioblastoma_expressed_matrix,"GENE")</span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_expressed_matrix &lt;- glioblastoma_expressed_matrix[,-1]</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># colnames(glioblastoma_expressed_matrix) &lt;-str_replace_all(colnames(glioblastoma_expressed_matrix),"\\.","-")</span></span>
<span id="cb3-22"></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creating seurat object :</span></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_seurat &lt;- CreateSeuratObject(</span></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># glioblastoma_expressed_matrix,</span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># project = "glioblastoma",</span></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># assay = "RNA",</span></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># min.cells = 0,</span></span>
<span id="cb3-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># min.features = 0,</span></span>
<span id="cb3-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># names.field = 1,</span></span>
<span id="cb3-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># names.delim = "_",</span></span>
<span id="cb3-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># meta.data = glioblastoma_metadata,</span></span>
<span id="cb3-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb3-34"></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SubsetBCmatrix &lt;- GetAssayData(object = BCdata, assay.type = "RNA", slot = "counts") </span></span>
<span id="cb3-36">plot1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FeatureScatter</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span>)</span>
<span id="cb3-37">plot2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FeatureScatter</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature1 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feature2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span>)</span>
<span id="cb3-38">plot2</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/pre processing-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">plot1</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/pre processing-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nFeature_RNA"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nCount_RNA"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"percent.mt"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pt.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/pre processing-3.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### FeatureScatter(object = seurat, feature1 = ?, feature2 = ?)  ## could be genes or meta data columns</span></span></code></pre></div>
</section>
<section id="variable-features-plot" class="level2">
<h2 class="anchored" data-anchor-id="variable-features-plot">Variable Features plot</h2>
<p>normalize data will be for new data</p>
<p>glioblastoma_seurat &lt;- NormalizeData(glioblastoma_seurat)</p>
<p>Variable gene selection</p>
<p>glioblastoma_seurat &lt;- FindVariableFeatures(glioblastoma_seurat, selection.method = “vst”, nfeatures = 2000)</p>
<p>scale data:</p>
<p>glioblastoma_seurat &lt;- ScaleData(glioblastoma_seurat)</p>
<p>glioblastoma_seurat &lt;- RunPCA(glioblastoma_seurat, features = VariableFeatures(object = glioblastoma_seurat))</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## what are our variable genes ?</span></span>
<span id="cb7-2">top10 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VariableFeatures</span>(glioblastoma_seurat), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb7-3">top10</span></code></pre></div>
<pre><code>## [1] "RGS1"    "VIM"     "HLA-DRA" "CD74"    "CCL4"</code></pre>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot variable features with and without labels</span></span>
<span id="cb9-2">plot1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VariableFeaturePlot</span>(glioblastoma_seurat)</span>
<span id="cb9-3">plot2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">LabelPoints</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> plot1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">points =</span> top10, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb9-4">plot1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot2</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/Feature-plot-1.jpeg" class="img-fluid"></p>
</section>
<section id="dim-pca-plot-dim-heatmap" class="level2">
<h2 class="anchored" data-anchor-id="dim-pca-plot-dim-heatmap">Dim-PCA plot, Dim-Heatmap</h2>
<p>prerform PCA on the scaled data. By default, only the previously determined variable features are used as input, but can be defined using features argument if you wish to choose a different subset.</p>
<p>glioblastoma_seurat &lt;- RunPCA(glioblastoma_seurat, features = VariableFeatures(object = glioblastoma_seurat))</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VizDimLoadings</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/Dim-PCA-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pca"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/Dim-PCA-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimHeatmap</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cells =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/Dim-PCA-3.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimHeatmap</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cells =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">balanced =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/Dim-PCA-4.jpeg" class="img-fluid"></p>
</section>
<section id="jackstraw-plot-elbowplot" class="level2">
<h2 class="anchored" data-anchor-id="jackstraw-plot-elbowplot">JackStraw Plot &amp; ElbowPlot</h2>
<p>approximate techniques such as those implemented in ElbowPlot() can be used to reducecomputation time</p>
<p>glioblastoma_seurat &lt;- JackStraw(glioblastoma_seurat, num.replicate = 100)</p>
<p>glioblastoma_seurat &lt;- ScoreJackStraw(glioblastoma_seurat, dims = 1:20)</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">JackStrawPlot</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dims =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/JackStraw Plot &amp; ElbowPlot-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ElbowPlot</span>(glioblastoma_seurat)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/JackStraw Plot &amp; ElbowPlot-2.jpeg" class="img-fluid"></p>
</section>
<section id="dimplot-tsne-umap" class="level2">
<h2 class="anchored" data-anchor-id="dimplot-tsne-umap">DimPlot tsne &amp; Umap</h2>
<p>glioblastoma_seurat &lt;- FindNeighbors(glioblastoma_seurat, dims = 1:10)</p>
<p>glioblastoma_seurat &lt;- FindClusters(glioblastoma_seurat, resolution = 0.5</p>
<p>glioblastoma_seurat &lt;- RunUMAP(glioblastoma_seurat, dims = 1:10)</p>
<p>glioblastoma_seurat &lt;- RunTSNE(glioblastoma_seurat, dims = 1:10)</p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># umap</span></span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"umap"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CellAssignment"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/tsne-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#tsne</span></span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DimPlot</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">reduction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tsne"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CellAssignment"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/tsne-2.jpeg" class="img-fluid"></p>
</section>
<section id="vlnplot" class="level2">
<h2 class="anchored" data-anchor-id="vlnplot">vlnPlot</h2>
<p>violin plot expression Palld between cell types</p>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># violin plot</span></span>
<span id="cb18-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># comprasion</span></span>
<span id="cb18-3">my_comp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malignant"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Macrophage"</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oligodendrocyte"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malignant"</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-cell"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malignant"</span>),</span>
<span id="cb18-4">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-cell"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oligodendrocyte"</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T-cell"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Macrophage"</span>),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Macrophage"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oligodendrocyte"</span>))</span>
<span id="cb18-5"></span>
<span id="cb18-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PALLD"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CellAssignment"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pt.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-7">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-8">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NoLegend</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylim</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/vlnplot-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># violint plot</span></span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PALLD"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CellAssignment"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pt.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-3">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb19-4">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NoLegend</span>()</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/vlnplot-2.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># violin plot multiple se</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VlnPlot</span>(glioblastoma_seurat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">features =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PALLD"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CellAssignment"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pt.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_compare_means</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'kruskal.test'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.y =</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylim</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cell Type"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_summary</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun.data =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_sdl"</span>,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pointrange"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_signif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comparisons =</span> my_comp,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">map_signif_level =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_position=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">NoLegend</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>))</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index_files/figure-html/vlnplot-3.jpeg" class="img-fluid"></p>
</section>
<section id="save-rds" class="level2">
<h2 class="anchored" data-anchor-id="save-rds">Save RDS</h2>
<p>to save rds run this command</p>
<p>saveRDS(glioblastoma_seurat, file = “C:/Users/user/Desktop/D/glioblastoma/glioblastoma_seurat.rds”)</p>


</section>

 ]]></description>
  <category>single cell</category>
  <category>glioblastoma</category>
  <guid>https://avivleemann.github.io/blog/blog/posts/2023-03-06-glioblastoma/index.html</guid>
  <pubDate>Sun, 05 Mar 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>miR-432-5p</title>
  <dc:creator>Aviv leemann</dc:creator>
  <link>https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-432-5p/index.html</link>
  <description><![CDATA[ 



<section id="enrichmet-analysis-hsa-mir-432-5p-targets" class="level1">
<h1>Enrichmet analysis: hsa-miR-432-5p targets</h1>
<p>enrichment analysis purpose is to check if there are: pathways, molecular function, biological process &amp; cellular components that is connected or related to this bio-marker target.</p>
<section id="libreris" class="level2">
<h2 class="anchored" data-anchor-id="libreris">libreris</h2>
<p>pacman library purpose is to load multiple libraries from a vector</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pacman)</span>
<span id="cb1-2">lab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.db"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GOstats"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cRegulome"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"readxl"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R.utils"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MeSHDbi"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AnnotationHub"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"KEGGREST"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AnnotationDbi"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"org.Hs.eg.db"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clusterProfiler"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meshr"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pathview"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ReactomePA"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meshes"</span>)</span>
<span id="cb1-3">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(lab,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">install =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">character.only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</section>
<section id="files" class="level2">
<h2 class="anchored" data-anchor-id="files">files</h2>
<p>loading miR targets files acquired from mirWalk</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">mir432_5p_targets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"miRWalk_miRNA_Targets_432_5p_3UTR.csv"</span>)</span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># annotations_ahb &lt;- read.csv("annotations_ahb.csv")</span></span></code></pre></div>
</section>
<section id="head" class="level2">
<h2 class="anchored" data-anchor-id="head">head</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">mir432_5p_targets <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<pre><code>##          mirnaid     refseqid genesymbol
## 1 hsa-miR-432-5p NM_001353214        DYM
## 2 hsa-miR-432-5p NM_001374442        DYM
## 3 hsa-miR-432-5p NM_001291932    SEC14L2
## 4 hsa-miR-432-5p NM_001301068       ARL1
## 5 hsa-miR-432-5p    NM_003387      WIPF1
## 6 hsa-miR-432-5p    NM_012215        OGA
##                                                                                    duplex
## 1 TCTTGGAGTAGGTCATTGGGTGG#CCACCCGGACCCCTCCAGC#..((((((..((((..(((((((#))))))))))).)))))).
## 2 TCTTGGAGTAGGTCATTGGGTGG#CCACCCGGACCCCTCCAGC#..((((((..((((..(((((((#))))))))))).)))))).
## 3 TCTTGGAGTAGGTCATTGGGTGG#ACCCAGGATTGTCTCCAAC#..((((((..((((.((((((..#))))))))))..)))))).
## 4 TCTTGGAGTAGGTCATTGGGTGG#CACCCATTCCTACTTTAGT#..((((((((((....((((((.#))))))..)))))))))).
## 5 TCTTGGAGTAGGTCATTGGGTGG#GCCTAATGACCCATTTCAC#...((((((.(((((((((((..#))))))))))).)))))).
## 6   TCTTGGAGTAGGTCATTGGGTGG#TACCTAGTGACTTCCAAC#..(((((...((((((((((((.#))))))))))))))))).
##   start  end  bindingp energy seed accessibility    au phylopstem phylopflank
## 1  2491 2510 0.9500000  -24.3    1   0.005542395 0.441  0.0000000   0.0000000
## 2  1756 1775 0.9500000  -24.3    1   0.005542395 0.441  0.0000000   0.0000000
## 3  3555 3574 0.9529915  -21.4    1   0.002860247 0.456  0.0000000   0.0000000
## 4  2116 2135 0.9538462  -22.2    1   0.232450300 0.603  1.2249763   0.8797262
## 5  3702 3721 0.9538462  -22.9    0   0.053886420 0.647  2.1715973   2.1847662
## 6  4641 4659 0.9538462  -21.3    0   0.048461950 0.588  0.9082432   1.0060216
##          me number_of_pairings binding_region_length
## 1 -8.224395                 17                    19
## 2 -8.224395                 17                    19
## 3 -7.991346                 16                    19
## 4 -8.071470                 16                    19
## 5 -7.757047                 17                    19
## 6 -9.569532                 17                    18
##   longest_consecutive_pairings position validated TargetScan miRDB
## 1                           11     3UTR                    0     0
## 2                           11     3UTR                    0     0
## 3                           10     3UTR                    0     0
## 4                           10     3UTR                    0     0
## 5                           11     3UTR                    0     0
## 6                           17     3UTR                    0     0</code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">mir432_5p_targets <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>()</span></code></pre></div>
<pre><code>##  [1] "mirnaid"                      "refseqid"                    
##  [3] "genesymbol"                   "duplex"                      
##  [5] "start"                        "end"                         
##  [7] "bindingp"                     "energy"                      
##  [9] "seed"                         "accessibility"               
## [11] "au"                           "phylopstem"                  
## [13] "phylopflank"                  "me"                          
## [15] "number_of_pairings"           "binding_region_length"       
## [17] "longest_consecutive_pairings" "position"                    
## [19] "validated"                    "TargetScan"                  
## [21] "miRDB"</code></pre>
</section>
<section id="preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="preprocessing">preprocessing</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(mir432_5p_targets)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SYMBOL"</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(mir432_5p_targets)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"miR"</span></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(mir432_5p_targets)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score"</span></span></code></pre></div>
<p>maps the gene to ENTREZID</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">mir432_5p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mapIds</span>(org.Hs.eg.db,</span>
<span id="cb8-2">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key =</span> mir432_5p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>SYMBOL,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data to use for retrieval</span></span>
<span id="cb8-3">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ENTREZID"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># information to retreive for given data</span></span>
<span id="cb8-4">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keytype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SYMBOL"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">multiVals =</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"first"</span> )</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mir_532_5_mapIDs &lt;- bitr( mir432_5p_targets$SYMBOL,  "SYMBOL","ENTREZID", OrgDb = org.Hs.eg.db)</span></span></code></pre></div>
</section>
<section id="kegg" class="level2">
<h2 class="anchored" data-anchor-id="kegg">KEGG</h2>
<p>run KEGG enrichment via cluster Profiler package</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">clusterProfiler_KEGG_432_5p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichKEGG</span>(mir432_5p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ)</span></code></pre></div>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(clusterProfiler_KEGG_432_5p)[, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>])</span></code></pre></div>
<pre><code>##                ID              Description GeneRatio  BgRatio       pvalue
## hsa05032 hsa05032       Morphine addiction   35/1487  91/8292 2.819029e-06
## hsa04727 hsa04727        GABAergic synapse   31/1487  89/8292 9.720160e-05
## hsa04728 hsa04728     Dopaminergic synapse   41/1487 132/8292 1.570806e-04
## hsa04713 hsa04713    Circadian entrainment   32/1487  97/8292 2.406306e-04
## hsa04014 hsa04014    Ras signaling pathway   64/1487 236/8292 2.570959e-04
## hsa04371 hsa04371 Apelin signaling pathway   42/1487 139/8292 2.572457e-04
##              p.adjust       qvalue Count
## hsa05032 0.0009387366 0.0007744911    35
## hsa04727 0.0142771350 0.0117791441    31
## hsa04728 0.0142771350 0.0117791441    41
## hsa04713 0.0142771350 0.0117791441    32
## hsa04014 0.0142771350 0.0117791441    64
## hsa04371 0.0142771350 0.0117791441    42</code></pre>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(clusterProfiler_KEGG_432_5p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showCategory=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-432-5p targets KEGG pathways"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-432-5p/index_files/figure-html/KEGG enrichment 432_5-1.jpeg" class="img-fluid"></p>
</section>
<section id="go-analysis" class="level2">
<h2 class="anchored" data-anchor-id="go-analysis">GO analysis</h2>
<section id="bp-analysis" class="level3">
<h3 class="anchored" data-anchor-id="bp-analysis">BP analysis</h3>
<p>no results</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">clusterProfiler_bp_432_5p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichGO</span>(mir432_5p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ont=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BP"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OrgDb =</span>org.Hs.eg.db)</span>
<span id="cb14-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#summary(clusterProfiler_bp_432_5p) %&gt;% head()</span></span>
<span id="cb14-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#dotplot(clusterProfiler_bp_432_5p, showCategory=20)</span></span></code></pre></div>
<p>no results</p>
</section>
<section id="cc-analysis" class="level3">
<h3 class="anchored" data-anchor-id="cc-analysis">CC analysis</h3>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">clusterProfiler_cc_432_5p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichGO</span>(mir432_5p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ont=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CC"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OrgDb =</span>org.Hs.eg.db)</span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(clusterProfiler_cc_432_5p)[,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>])</span></code></pre></div>
<pre><code>##                    ID                           Description GeneRatio   BgRatio
## GO:0005769 GO:0005769                        early endosome  104/3317 414/19869
## GO:0031965 GO:0031965                      nuclear membrane   79/3317 305/19869
## GO:0005635 GO:0005635                      nuclear envelope  116/3317 488/19869
## GO:0031228 GO:0031228 intrinsic component of Golgi membrane   25/3317  69/19869
## GO:0000151 GO:0000151              ubiquitin ligase complex   78/3317 309/19869
## GO:0043197 GO:0043197                       dendritic spine   49/3317 175/19869
##                  pvalue    p.adjust      qvalue Count
## GO:0005769 6.841258e-06 0.005199356 0.004500828   104
## GO:0031965 2.694279e-05 0.007917530 0.006853817    79
## GO:0005635 3.125341e-05 0.007917530 0.006853817   116
## GO:0031228 7.110974e-05 0.011447826 0.009909821    25
## GO:0000151 7.705279e-05 0.011447826 0.009909821    78
## GO:0043197 1.164215e-04 0.011447826 0.009909821    49</code></pre>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(clusterProfiler_cc_432_5p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showCategory=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-432-5p targets CC GO"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-432-5p/index_files/figure-html/CC 432_5-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goplot</span>(clusterProfiler_cc_432_5p )</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-432-5p/index_files/figure-html/goplot cc-1.jpeg" class="img-fluid"></p>
</section>
<section id="mf-analysis" class="level3">
<h3 class="anchored" data-anchor-id="mf-analysis">MF analysis</h3>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">clusterProfiler_mf_432_5p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichGO</span>(mir432_5p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ont=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MF"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OrgDb =</span>org.Hs.eg.db)</span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(clusterProfiler_mf_432_5p)[,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>] )</span></code></pre></div>
<pre><code>##                    ID                   Description GeneRatio   BgRatio
## GO:0019001 GO:0019001     guanyl nucleotide binding  111/3240 401/18432
## GO:0032561 GO:0032561 guanyl ribonucleotide binding  111/3240 401/18432
## GO:0003924 GO:0003924               GTPase activity   94/3240 331/18432
## GO:0005525 GO:0005525                   GTP binding  104/3240 379/18432
## GO:0019003 GO:0019003                   GDP binding   30/3240  73/18432
## GO:0003925 GO:0003925            G protein activity   18/3240  41/18432
##                  pvalue     p.adjust       qvalue Count
## GO:0019001 2.696462e-07 0.0001620574 0.0001558271   111
## GO:0032561 2.696462e-07 0.0001620574 0.0001558271   111
## GO:0003924 6.380072e-07 0.0002556282 0.0002458007    94
## GO:0005525 9.916314e-07 0.0002979852 0.0002865293   104
## GO:0019003 2.039762e-06 0.0004903587 0.0004715070    30
## GO:0003925 7.950900e-05 0.0159283036 0.0153159448    18</code></pre>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(clusterProfiler_mf_432_5p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showCategory=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-432-5p targets MF GO"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-432-5p/index_files/figure-html/MF 432_5-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goplot</span>(clusterProfiler_mf_432_5p )</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-432-5p/index_files/figure-html/goplot mf-1.jpeg" class="img-fluid"></p>
</section>
</section>
<section id="reactome-pathways" class="level2">
<h2 class="anchored" data-anchor-id="reactome-pathways">Reactome Pathways</h2>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">reactome_432_5<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichPathway</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene=</span>mir432_5p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pvalueCutoff =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">readable=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb23-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(reactome_432_5,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showCategory=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-432-5p targets reactome pathways"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-432-5p/index_files/figure-html/reactome pathways-1.jpeg" class="img-fluid"></p>
</section>
<section id="mesh" class="level2">
<h2 class="anchored" data-anchor-id="mesh">MESH</h2>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># already created </span></span>
<span id="cb24-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creating meshDBi</span></span>
<span id="cb24-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ah &lt;- AnnotationHub(localHub=TRUE)</span></span>
<span id="cb24-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hsa &lt;- query(ah, c("MeSHDb", "Homo sapiens"))</span></span>
<span id="cb24-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># file_hsa &lt;- hsa[[1]]</span></span>
<span id="cb24-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># db &lt;- MeSHDbi::MeSHDb(file_hsa)</span></span></code></pre></div>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># saved &amp; read the mehses </span></span>
<span id="cb25-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># meshes432 &lt;- enrichMeSH(mir432_5p_targets$ENTREZ, MeSHDb = db, database='gendoo', category = 'C')</span></span>
<span id="cb25-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># saveRDS(meshes432,'meshes432.rds')</span></span>
<span id="cb25-4">meshes432 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'meshes432.rds'</span>)</span>
<span id="cb25-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(meshes432) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-432-5p targets mesh gendoo Diseases"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-432-5p/index_files/figure-html/mesh gendoo-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># meshes432_pubmed &lt;- enrichMeSH(mir432_5p_targets$ENTREZ, MeSHDb = db, database='gene2pubmed', category = 'C')</span></span>
<span id="cb26-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dotplot(meshes432_pubmed) + labs(title ="hsa-miR-432-5p targets mesh gene2pubmed Diseases")</span></span></code></pre></div>
</section>
</section>
<section id="session-info" class="level1">
<h1>session info</h1>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]</span></code></pre></div>
<pre><code>## $basePkgs
## [1] "stats4"    "stats"     "graphics"  "grDevices" "utils"     "datasets" 
## [7] "methods"   "base"</code></pre>


</section>

 ]]></description>
  <category>enrichment</category>
  <category>miR-432-5p</category>
  <guid>https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-432-5p/index.html</guid>
  <pubDate>Sun, 05 Mar 2023 22:00:00 GMT</pubDate>
</item>
<item>
  <title>miR-486-3p</title>
  <dc:creator>Aviv leemann</dc:creator>
  <link>https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index.html</link>
  <description><![CDATA[ 



<section id="enrichmet-analysis-hsa-mir-486-3p-targets" class="level1">
<h1>Enrichmet analysis: hsa-miR-486-3p targets</h1>
<p>enrichment analysis purpose is to check if there are: pathways, molecular function, biological process &amp; cellular components that is connected or related to this bio-marker target.</p>
<section id="libreris" class="level2">
<h2 class="anchored" data-anchor-id="libreris">libreris</h2>
<p>pacman library purpose is to load multiple libraries from a vector</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pacman)</span>
<span id="cb1-2">lab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO.db"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GOstats"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cRegulome"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"readxl"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R.utils"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MeSHDbi"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AnnotationHub"</span>,</span>
<span id="cb1-3">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AnnotationDbi"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"org.Hs.eg.db"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clusterProfiler"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meshr"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pathview"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ReactomePA"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"meshes"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyverse"</span>)</span>
<span id="cb1-4">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(lab,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">install =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">character.only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</section>
<section id="files" class="level2">
<h2 class="anchored" data-anchor-id="files">files</h2>
<p>loading miR targets files acquired from mirWalk</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">mir486_3p_targets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"miRWalk_miRNA_Targets_486_3p_3UTR.csv"</span>)</span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># annotations_ahb &lt;- read.csv("annotations_ahb.csv")</span></span></code></pre></div>
</section>
<section id="head" class="level2">
<h2 class="anchored" data-anchor-id="head">Head</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">mir486_3p_targets <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<pre><code>##          mirnaid     refseqid genesymbol
## 1 hsa-miR-486-3p    NM_145725      TRAF3
## 2 hsa-miR-486-3p    NM_198217       ING1
## 3 hsa-miR-486-3p    NM_024295      DERL1
## 4 hsa-miR-486-3p    NM_004308    ARHGAP1
## 5 hsa-miR-486-3p    NM_006390       IPO8
## 6 hsa-miR-486-3p NM_001042669   ARHGAP24
##                                                                                          duplex
## 1           CGGGGCAGCTCAGTACAGGAT#CCTGTGCCCTGAGCTCCCG#..(((.(((((((((((((..#)))))))..))))))))).
## 2             CGGGGCAGCTCAGTACAGGAT#TGCTGTATGTGAGCTGTA#....((((((((((((((.(.#).)))))).)))))))).
## 3         CGGGGCAGCTCAGTACAGGAT#GTCCCTGCTCTGCTGTCTCT#.((((((((..((((..((((#)))).))))..)))))))).
## 4 CGGGGCAGCTCAGTACAGGAT#TCCCTATCTGGTAGGCTGCCCTGC#(((((((((((((....(((.#)))....)))...)))))))))).
## 5         CGGGGCAGCTCAGTACAGGAT#CCTGCTGCTGGGGGGCTTTT#.(((((..(((((((((((..#)))).)))))))..))))).
## 6               CGGGGCAGCTCAGTACAGGAT#CTGTGCTGTTTGTGCCA#.((.((((..((((((((...#)))))))).)))).)).
##   start  end  bindingp energy seed accessibility    au phylopstem phylopflank
## 1  4050 4069 0.9538462  -25.8    0  1.931234e-03 0.250  0.0000000   0.0000000
## 2  1841 1859 0.9538462  -20.6    0  1.342227e-03 0.632  2.0375295   1.0278025
## 3  3060 3080 0.9538462  -20.5    1  6.949161e-02 0.618  0.4188013   1.3100478
## 4  1886 1910 0.9538462  -24.1    1  3.465340e-06 0.397  0.6887471   0.3595709
## 5  3892 3912 0.9538462  -20.8    0  8.965582e-05 0.485  3.9497398   4.8023135
## 6  2656 2673 0.9538462  -20.5    0  3.894453e-04 0.632  2.1409307   1.7314363
##          me number_of_pairings binding_region_length
## 1 -6.857959                 16                    19
## 2 -9.546562                 15                    18
## 3 -8.093655                 16                    20
## 4 -5.762913                 16                    24
## 5 -7.650646                 16                    20
## 6 -9.124243                 14                    17
##   longest_consecutive_pairings position validated TargetScan miRDB
## 1                            9     3UTR                    0     1
## 2                            8     3UTR                    0     0
## 3                            8     3UTR                    0     0
## 4                           10     3UTR                    0     1
## 5                            7     3UTR                    0     0
## 6                            8     3UTR                    0     0</code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">mir486_3p_targets <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>()</span></code></pre></div>
<pre><code>##  [1] "mirnaid"                      "refseqid"                    
##  [3] "genesymbol"                   "duplex"                      
##  [5] "start"                        "end"                         
##  [7] "bindingp"                     "energy"                      
##  [9] "seed"                         "accessibility"               
## [11] "au"                           "phylopstem"                  
## [13] "phylopflank"                  "me"                          
## [15] "number_of_pairings"           "binding_region_length"       
## [17] "longest_consecutive_pairings" "position"                    
## [19] "validated"                    "TargetScan"                  
## [21] "miRDB"</code></pre>
</section>
<section id="pre-processing" class="level2">
<h2 class="anchored" data-anchor-id="pre-processing">Pre-Processing</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(mir486_3p_targets)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SYMBOL"</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(mir486_3p_targets)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"miR"</span></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(mir486_3p_targets)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score"</span></span></code></pre></div>
<p>maps the gene to ENTREZID</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">mir486_3p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mapIds</span>(org.Hs.eg.db,</span>
<span id="cb8-2">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">key =</span> mir486_3p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>SYMBOL,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data to use for retrieval</span></span>
<span id="cb8-3">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ENTREZID"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># information to retreive for given data</span></span>
<span id="cb8-4">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">keytype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SYMBOL"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">multiVals =</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"first"</span> )</span></code></pre></div>
</section>
<section id="kegg" class="level2">
<h2 class="anchored" data-anchor-id="kegg">KEGG</h2>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">clusterProfiler_KEGG_486_3p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichKEGG</span>(mir486_3p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ)</span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(clusterProfiler_KEGG_486_3p)[, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>])</span></code></pre></div>
<pre><code>##                ID                     Description GeneRatio  BgRatio
## hsa04144 hsa04144                     Endocytosis   80/1683 251/8292
## hsa04713 hsa04713           Circadian entrainment   38/1683  97/8292
## hsa04725 hsa04725             Cholinergic synapse   39/1683 113/8292
## hsa04728 hsa04728            Dopaminergic synapse   44/1683 132/8292
## hsa05163 hsa05163 Human cytomegalovirus infection   67/1683 225/8292
## hsa04010 hsa04010          MAPK signaling pathway   83/1683 294/8292
##                pvalue    p.adjust      qvalue Count
## hsa04144 7.764621e-06 0.002311347 0.001768124    80
## hsa04713 1.388196e-05 0.002311347 0.001768124    38
## hsa04725 2.763010e-04 0.023492414 0.017971121    39
## hsa04728 2.821912e-04 0.023492414 0.017971121    44
## hsa05163 3.949912e-04 0.026306414 0.020123762    67
## hsa04010 5.727129e-04 0.027849950 0.021304529    83</code></pre>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(clusterProfiler_KEGG_486_3p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showCategory=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-486-3p targets KEGG pathways"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index_files/figure-html/KEGG enrichment 486_3-1.jpeg" class="img-fluid"></p>
</section>
<section id="go-analysis" class="level2">
<h2 class="anchored" data-anchor-id="go-analysis">GO analysis</h2>
<section id="bp-analysis" class="level3">
<h3 class="anchored" data-anchor-id="bp-analysis">BP analysis</h3>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">clusterProfiler_bp_486_3p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichGO</span>(mir486_3p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ont=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BP"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OrgDb =</span>org.Hs.eg.db)</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(clusterProfiler_bp_486_3p)[,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<pre><code>##                    ID
## GO:0010975 GO:0010975
## GO:0007265 GO:0007265
## GO:0031345 GO:0031345
## GO:0032535 GO:0032535
## GO:0043161 GO:0043161
## GO:1901888 GO:1901888
##                                                                  Description
## GO:0010975                       regulation of neuron projection development
## GO:0007265                                   Ras protein signal transduction
## GO:0031345               negative regulation of cell projection organization
## GO:0032535                             regulation of cellular component size
## GO:0043161 proteasome-mediated ubiquitin-dependent protein catabolic process
## GO:1901888                              regulation of cell junction assembly
##            GeneRatio   BgRatio       pvalue    p.adjust      qvalue Count
## GO:0010975  128/3603 446/18903 4.050520e-07 0.002583827 0.002304107   128
## GO:0007265  103/3603 353/18903 2.375428e-06 0.003794737 0.003383925   103
## GO:0031345   64/3603 194/18903 2.590133e-06 0.003794737 0.003383925    64
## GO:0032535  106/3603 367/18903 2.847823e-06 0.003794737 0.003383925   106
## GO:0043161  125/3603 450/18903 3.450878e-06 0.003794737 0.003383925   125
## GO:1901888   66/3603 204/18903 3.861954e-06 0.003794737 0.003383925    66</code></pre>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(clusterProfiler_bp_486_3p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showCategory=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-486-3p targets BP GO"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index_files/figure-html/BP 486_3-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goplot</span>(clusterProfiler_bp_486_3p)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index_files/figure-html/goplot bp-1.jpeg" class="img-fluid"></p>
</section>
<section id="cc-analysis" class="level3">
<h3 class="anchored" data-anchor-id="cc-analysis">CC analysis</h3>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">clusterProfiler_cc_486_3p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichGO</span>(mir486_3p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ont=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CC"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OrgDb =</span>org.Hs.eg.db)</span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(clusterProfiler_cc_486_3p)[,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<pre><code>##                    ID          Description GeneRatio   BgRatio       pvalue
## GO:0070382 GO:0070382     exocytic vesicle   79/3786 226/19869 1.093423e-08
## GO:0008021 GO:0008021     synaptic vesicle   74/3786 208/19869 1.346856e-08
## GO:0097060 GO:0097060    synaptic membrane  116/3786 378/19869 2.969717e-08
## GO:0031252 GO:0031252    cell leading edge  124/3786 421/19869 1.321625e-07
## GO:0030133 GO:0030133    transport vesicle  124/3786 423/19869 1.758511e-07
## GO:0042734 GO:0042734 presynaptic membrane   52/3786 148/19869 2.792795e-06
##                p.adjust       qvalue Count
## GO:0070382 5.205599e-06 4.175254e-06    79
## GO:0008021 5.205599e-06 4.175254e-06    74
## GO:0097060 7.651971e-06 6.137415e-06   116
## GO:0031252 2.554041e-05 2.048519e-05   124
## GO:0030133 2.718658e-05 2.180554e-05   124
## GO:0042734 3.598051e-04 2.885888e-04    52</code></pre>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(clusterProfiler_cc_486_3p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showCategory=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-486-3p targets CC GO"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index_files/figure-html/CC 486_3-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goplot</span>(clusterProfiler_cc_486_3p)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index_files/figure-html/goplot cc-1.jpeg" class="img-fluid"></p>
</section>
<section id="mf-analysis" class="level3">
<h3 class="anchored" data-anchor-id="mf-analysis">MF analysis</h3>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">clusterProfiler_mf_486_3p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichGO</span>(mir486_3p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ont=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MF"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OrgDb =</span>org.Hs.eg.db)</span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(clusterProfiler_mf_486_3p)[,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<pre><code>##                    ID                                    Description GeneRatio
## GO:0060090 GO:0060090                     molecular adaptor activity  140/3717
## GO:0030674 GO:0030674         protein-macromolecule adaptor activity  103/3717
## GO:0004879 GO:0004879                      nuclear receptor activity   23/3717
## GO:0098531 GO:0098531 ligand-activated transcription factor activity   23/3717
## GO:0008013 GO:0008013                           beta-catenin binding   33/3717
## GO:0003779 GO:0003779                                  actin binding  121/3717
##              BgRatio       pvalue    p.adjust      qvalue Count
## GO:0060090 492/18432 5.209521e-06 0.006324359 0.005999175   140
## GO:0030674 347/18432 1.334855e-05 0.008102569 0.007685954   103
## GO:0004879  52/18432 7.225950e-05 0.020539875 0.019483763    23
## GO:0098531  52/18432 7.225950e-05 0.020539875 0.019483763    23
## GO:0008013  87/18432 9.768138e-05 0.020539875 0.019483763    33
## GO:0003779 439/18432 1.015150e-04 0.020539875 0.019483763   121</code></pre>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(clusterProfiler_mf_486_3p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showCategory=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-486-3p targets MF GO"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index_files/figure-html/MF 486_3-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">goplot</span>(clusterProfiler_mf_486_3p)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index_files/figure-html/goplot mf-1.jpeg" class="img-fluid"></p>
</section>
</section>
<section id="reactome-pathways" class="level2">
<h2 class="anchored" data-anchor-id="reactome-pathways">Reactome Pathways</h2>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">reactome_486_3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enrichPathway</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene=</span>mir486_3p_targets<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ENTREZ, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pvalueCutoff =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">readable=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(reactome_486_3,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">showCategory=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-486-3p targets reactome pathways"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index_files/figure-html/reactome-1.jpeg" class="img-fluid"></p>
</section>
<section id="mesh" class="level2">
<h2 class="anchored" data-anchor-id="mesh">MESH</h2>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># already created </span></span>
<span id="cb25-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># creating meshDBi</span></span>
<span id="cb25-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ah &lt;- AnnotationHub(localHub=TRUE)</span></span>
<span id="cb25-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hsa &lt;- query(ah, c("MeSHDb", "Homo sapiens"))</span></span>
<span id="cb25-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># file_hsa &lt;- hsa[[1]]</span></span>
<span id="cb25-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># db &lt;- MeSHDbi::MeSHDb(file_hsa)</span></span></code></pre></div>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># meshes486 &lt;- enrichMeSH(mir486_3p_targets$ENTREZ, MeSHDb = db, database='gendoo', category = 'C')</span></span>
<span id="cb26-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># saveRDS(meshes486,'meshes486.rds')</span></span>
<span id="cb26-3">meshes486 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'meshes486.rds'</span>)</span>
<span id="cb26-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dotplot</span>(meshes486) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hsa-miR-486-3p targets mesh gendoo Diseases"</span>)</span></code></pre></div>
<p><img src="https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index_files/figure-html/meshes gendoo-1.jpeg" class="img-fluid"></p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># saveRDS(meshes486,'meshes486.rds')</span></span></code></pre></div>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># meshes486_pubmed &lt;- enrichMeSH(mir486_3p_targets$ENTREZ, MeSHDb = db, database='gene2pubmed', category = 'C')</span></span>
<span id="cb28-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dotplot(meshes486) + labs(title ="hsa-miR-486-3p targets mesh gene2pubmed Diseases")</span></span></code></pre></div>
</section>
</section>
<section id="session-info" class="level1">
<h1>session info</h1>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]</span></code></pre></div>
<pre><code>## $basePkgs
## [1] "stats4"    "stats"     "graphics"  "grDevices" "utils"     "datasets" 
## [7] "methods"   "base"</code></pre>


</section>

 ]]></description>
  <category>enrichment</category>
  <category>miR-486-3p</category>
  <guid>https://avivleemann.github.io/blog/blog/posts/2023-03-06-mir-486-3p/index.html</guid>
  <pubDate>Sun, 05 Mar 2023 22:00:00 GMT</pubDate>
</item>
</channel>
</rss>
